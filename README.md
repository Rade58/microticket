# WORKER SERVICES

DAKLE ZELIMO DA SE POZABAVIMO, ONOM IDEJOM O KOJOJ SMO GOVORILI, A TO JE **IDEJA O EXPIRINGU ORDER-A AFTER SOME GIVEN TIME**

AKO SE SECAS, KADA KRIRAMO ORDER MI MU SETT-UJEMO `expiresAt` FIELD, KOJI JE USTVARI ISOS STRING, KOJI JE USTVATI TIME STRING; A SET-OVALI SMO NEK IAT U BUDUCNOSTI NARAVNO, USTVARI DEFINISALI SM ODA TO BUDE 15 MINUTA OD KREIRANJA ORDER-A

# MI ZATO ZELIMO DA NAPRAVIMO `expiration` MICROSERVICE

NJEGOV POSAO CE BITI DA WATCH-UJE ZA `"order:created"` KANAL; 

**I OVAJ MICROSERVICE TREBA DA ISSU-JE EVENT, KOJI BI SE MOZDA ZVAO `"expiration:complete"`**

**NA `"expiration:complete"` BI BIO SUBSCRIBED `orders` MICROSERVICE, CIME BI MOGAO DA ZNA DA JE NEKI NJEGOV SPECIFIC OREDER, USTVARI EXPIRE-OVAO**

NA OSNOVU TOGA `orders` MICROSERVICE BI MOGAO DA CANCELL-UJE THE ORDER

# SADA JE JEDINI CHALLENGE, KAKO DA MI USTVARI DEFINISEMO DA SE U TOM NASEM NOVOM MICROSERVICE-U EVENT-OVI PUBLJISH-UJU, TACNO NAKON ONOG VREMENA ZA KOJE JE POTREBNO DA TICKET EXPIRE-UJE

IMAMO NEKOLIKO DIFFERENT OPTIONS KOJEU ZA TO MOZEMO IZABRATI (CETIRI DO PET OPCIJA USTVARI) DA KORISTIMO

DAKLE TREBA NAM OPCIJA KOJOM MOZEMO IMPLMENTIRATI TIMER U NASEM `expiration` MICROSERVICE-U, KOJEG TEK TREBAMO NAPRAVITI

# PRE NEGO STO VIDIMO KOJI SU TO COUPLE OF DIFFERENT WAYS FOR MAKING SURE THAT `expiration` MICROSERVICE WAITS BEFORE EMMITING `"expiration:complete"` EVENT; ZAMISLICEMO I POSMATRACEMO `expiration` MICROSERVICE IN ISOLATION

IDEJA JE DA:

`"order:created"` COMES IN

**I ONDA EMO IMATI NEKI MECHANISM INSIDE `expiration` MICROSERVICE, KOJI CE WAIT-OVATI ONIH 15 MINUTA, ILI AKO SE ODLUCIM DA PODESIM DRUGO VREME**

**I ZELIM ODA KADA PRODJE TAJ PERIOD DA TAJ MECHANISM EMMIT-UJE EVENT U `"expiration:complete"` CHANNEL**

MI TREBA, USTVARI DA PUBLISH-UJEMO EVENT, KADA ONAJ TIMESTAMP, KOJI CUVAMO U TICKETU, KAO `expiresAt`; **USTVSRI *"PREDJE IZ FUTURE-A, TO THE PAST"***

**ODNONO DA EMMIT-UJEMO EVENT AT THE TIME, KOJI TAJ TIMESTMAP OPISUJE**

**JER AKO SE SECAS, TAJ TIMESTAMP SMO KREIRALI TAKO STO SMO UZELI CURRENT TIME, I UVECALI GA ZA 15 MINUTA, DA PREDSTAVLJA TIME IN THE FUTURE**

# EVO NEKOLIKO NACINA KOJIMA MOZEMO IMPLEMENTIRATI TAJ EMMITING, U TRENUTKU VREMENA KOJI OPISUJE TIMESTAMP

`setTimeout` BAS I NIJE OPCIJA, PREVENSTVENO JER JE TIMER STORED IN MEMORY I AKO SERVICE RESTARTS, ALL TIMERS ARE LOST
